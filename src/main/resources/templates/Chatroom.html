<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <link rel="stylesheet" type ="text/css" th:href ="@{/ChatRoomStyle.css}">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

    <style>
        .topnav {
            list-style-type: none;
            margin: 0;
            padding: 0;
            overflow: hidden;
            background-color: #333;
        }

        .topnav a{
            float: left;
        }

        .topnav a {
            display: block;
            color: white;
            text-align: center;
            padding: 14px 16px;
            text-decoration: none;
        }

        .topnav a:hover:not(.active) {
            background-color: #111;
        }

        .active {
            background-color: #4CAF50;
        }
    </style>
    <div class="topnav">
        <a  href="/menu">Home</a>
        <a href="/review">Game Reviews</a>
        <a  href="/NewsFeed">Newsfeed</a>
        <a class="active" href="/chatroom">Chatrooms</a>
        <a  href="/friends">Friends</a>
    </div>
</head>
<body style="background-color:#99aab5;">

<div class ="ChatContainer">
    <div class ="ChatHeader">
        <h3>Welcome to the chatroom</h3>

<!----EP1------->
        <form th:action="@{/chatroom/newUser}" id="newuser" method="post">
            <input type ="text" name ="name" id ="text2" placeholder="Enter a gamertag to add user to the chat"/>
            <input type ="button"  id ="button1" value ="Add" />
        </form>
<script>

    $("#button1").click(function () {
        $.ajax({
            url: $("#newuser").attr("action")+"?name="+$("#text2").val(),
            type: $("#newuser").attr("method"),
            contentType: 'application/json',
            success: function(data){
            }
        });

    });
</script>

 <!----EP2------->
       <form th:action="@{/chatroom/getChatUsers}" id="getUsers" method="get">
           <input type="submit" value="Show User List">
       </form>

<!----EP3------->
        <form th:action="@{/chatroom/removeUser}" id="removeUser" method="delete">
            <input type ="text" name ="name" id ="text3" placeholder="Enter the name of the user you want removed from the chat"/>
            <input type="button" id="button2" value="remove">
        </form>

        <script>

            $("#button2").click(function () {
                $.ajax({
                    url: $("#removeUser").attr("action")+"?name="+$("#text3").val(),
                    type: $("#removeUser").attr("method"),
                    contentType: 'application/json',
                    success: function(data){
                    }
                });

            });
        </script>


    </div>
    <div class="chatMessages">
        <ul id="list" >
        </ul>
    </div>

    <div class="chatBottom">

    <form action = "#" onSubmit = "return false;" id="chatForm">
        <input type ="hidden" id ="name";/>
        <input type ="text" name ="text" id ="text" value=''placeholder="type your chat message"/>
        <input type ="submit" onclick="addLi()" name="submit" value ="Post"/>


    </form>

        <script>

            function addLi()
            {
                var txtVal = document.getElementById('text').value;
                if(txtVal ===""){
                    alert("please enter data into the field.")
            }else {
                    listNode = document.getElementById('list'),
                        liNode = document.createElement("LI"),
                        txtNode = document.createTextNode("<" +text2.value+"> " + text.value);
                    liNode.appendChild(txtNode);
                    listNode.appendChild(liNode);
                    document.getElementById('text').value ="";
                }
            }
        </script>
    </div>
</div>
</body>
</html>